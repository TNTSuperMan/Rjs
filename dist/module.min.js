let e=[],t=[];const s=()=>t[t.length-1];let o=!1;const r=e=>n(e,e),n=(s,r)=>{t.push([]),o=!0,s(),t.length<=1&&(o=!1);const n=t.pop();return n?(e.push(...n.map((e=>[e[0],e[1],r]))),n.map((e=>[e[0],e[1]]))):[]},h=t=>e=e.filter((e=>!t.some((t=>t[0]!=e[0]||2!=t.length||t[1]==e[1])))),c=[],i=t=>{const r=Symbol(),{proxy:n,revoke:i}=Proxy.revocable(t,{get:(e,t,n)=>(o&&!s().some((e=>e[0]==r&&e[1]==t))&&s().push([r,t]),Reflect.get(e,t,n)),set(t,s,o,n){const h=Reflect.set(t,s,o,n);return e.filter((e=>e[0]==r&&e[1]==s)).forEach((e=>e[2]())),h}});return c.push([t,r,()=>{i(),h([[r]])}]),[n,r]};class d{node;#e;#t;#s;constructor(e,t=[]){this.node=e,this.#e=t,this.#s=e.remove.bind(e),this.#t=[],e.remove=()=>this.destroy()}update(){var t;t=this.#e,e.filter((e=>t.some((t=>t[0]==e[0]&&t[1]==e[1])))).forEach((e=>e[2]()))}destroy(){for(this.#t.forEach((e=>(e=>{const t=c.findIndex((t=>t[1]==e));-1!=t&&(c[t][2](),c.splice(t,1))})(e))),h(this.#e);this.node.childNodes.length;)this.node.childNodes[0].remove();this.#s()}fook(e,t){this.#e.push(...n(e,t))}calculate(e){const t=i({value:e()});return this.#t.push(t[1]),this.#e.push(...r((()=>t[0].value=e()))),t[0]}addProxy(e){this.#t.push(e)}}function a(e,t,s=()=>({}),o={}){const n=document.createElement(e),h=[];return h.push(...r((()=>{Object.entries(s()).forEach((e=>n.setAttribute(e[0],e[1])))}))),h.push(...r((()=>{for(;n.childNodes.length;)n.childNodes[0].remove();t().forEach((e=>n.appendChild(e.node)))}))),Object.entries(o).forEach((e=>n.addEventListener(e[0],e[1]))),new d(n,h)}function l(e){const t=new Text;return new d(t,r((()=>t.nodeValue=e())))}export{d as VNode,i as createProxy,a as createVElement,l as createVText};
