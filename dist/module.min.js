let e=[],t=[],r=!1;const o=[],s=()=>t[t.length-1],c=e=>n(e,e),n=(o,s)=>{t.push([]),r=!0,o(),t.length<=1&&(r=!1);const c=t.pop();return c?(e.push(...c.map((e=>[e[0],e[1],s]))),c.map((e=>[e[0],e[1]]))):[]};class a{node;#e;#t=[];#r;constructor(e,t,r){this.node=e,this.#e=t,this.#r=r}update(){var t;t=this.#e,e.filter((e=>t.some((t=>t[0]==e[0]&&t[1]==e[1])))).forEach((e=>e[2]()))}destroy(){var t;this.#t.forEach((e=>(e=>{const t=o.findIndex((t=>t[1]==e));-1!=t&&(o[t][2](),o.splice(t,1))})(e))),t=this.#e,e=e.filter((e=>!t.some((t=>t[0]==e[0]&&t[1]==e[1])))),this.node.childNodes.forEach((e=>e.remove())),this.#r()}fook(e,t){this.#e.push(...n(e,t))}createProxy(t){const c=(t=>{const c=Symbol(),{proxy:n,revoke:a}=Proxy.revocable(t,{get:(e,t,o)=>(r&&!s().some((e=>e[0]==c&&e[1]==t))&&s().push([c,t]),Reflect.get(e,t,o)),set(t,r,o,s){const n=Reflect.set(t,r,o,s);return e.filter((e=>e[0]==c&&e[1]==r)).forEach((e=>e[2]())),n}});return o.push([t,c,()=>{a(),e=e.filter((e=>e[0]!=c))}]),[n,c]})(t);return this.#t.push(c[1]),c[0]}}function h(e,t,r,o){const s=document.createElement(e),n=[];n.push(...c((()=>{Object.entries(t()).forEach((e=>s.setAttribute(e[0],e[1])))}))),n.push(...c((()=>{s.childNodes.forEach((e=>e.remove())),r().forEach((e=>s.appendChild(e.node)))}))),Object.entries(o).forEach((e=>s.addEventListener(e[0],e[1])));const h=s.remove.bind(s),i=new a(s,n,h);return s.remove=()=>i.destroy(),i}function i(e){const t=new Text;let r=c((()=>t.nodeValue=e()));const o=t.remove.bind(t),s=new a(t,r,o);return t.remove=()=>s.destroy(),s}export{h as createVElement,i as createVText};
